<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% seo %}
    {% if page.head_include %}
    {% include {{ page.head_include }} %}
    {% endif %}
    <!-- Prevent FOUC: Apply saved theme before render -->
    <script>
        (function () {
            const savedMode = localStorage.getItem('mode');
            if (savedMode) {
                document.documentElement.setAttribute('data-theme', savedMode);
            }
        })();
    </script>
    <!-- CSS -->
    <link rel="stylesheet" href="{{ '/stylesheets/main.css' | relative_url }}">
    <!-- Favicon after CSS -->
    <link id="favicon" rel="icon" href="/assets/site-logo.png" type="image/png">

    <!-- Structured Data -->
    <!-- TODO: is this needed? -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Kai Qu",
      "url": "https://k7m.xyz",
      "image": "https://k7m.xyz/assets/site-logo.png",
      "jobTitle": "Software Engineer",
      "worksFor": {
        "@type": "Organization",
        "name": "Baidu"
      },
      "sameAs": [
        "https://github.com/faithk7",
        "https://www.linkedin.com/in/kqu1106/",
        "https://read.cv/lastk7",
        "https://www.kaggle.com/faithk7u"
      ],
      "description": "Software engineer based in Beijing, China. Loves reading, running and watching anime.",
      "nationality": {
        "@type": "Country",
        "name": "China"
      },
      "alumniOf": [
        {
          "@type": "CollegeOrUniversity",
          "name": "University of Virginia"
        }
      ]
    }
    </script>

    {% if page.layout == 'writing' and page.date %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "{{ page.title | replace: '| Kai Qu', '' | strip }}",
      "author": {
        "@type": "Person",
        "name": "Kai Qu",
        "url": "https://k7m.xyz"
      },
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "dateModified": "{{ page.date | date_to_xmlschema }}",
      "description": "{{ page.description | default: page.excerpt | strip_html | truncatewords: 50 }}",
      "url": "{{ page.url | absolute_url }}",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ page.url | absolute_url }}"
      },
      "publisher": {
        "@type": "Person",
        "name": "Kai Qu",
        "logo": {
          "@type": "ImageObject",
          "url": "https://k7m.xyz/assets/site-logo.png"
        }
      }{% if page.keywords or page.tags %},
      "keywords": "{{ page.keywords | default: page.tags | join: ', ' }}"{% endif %}{% if page.lang %},
      "inLanguage": "{{ page.lang }}"{% endif %}
    }
    </script>
    {% endif %}
</head>

<body data-page="{{ page.url }}" data-layout="{{ page.layout }}">
    <div class="l-container">
        <div class="l-grid l-left">
            <!-- Left empty space (3 parts) -->
        </div>
        <div class="l-grid l-center">
            <!-- Main content (6 parts) -->
            {{ content }}
        </div>
        <div class="l-grid l-right">
            <!-- Navbar (3 parts) -->
            {% include nav.html %}
        </div>
    </div>

    <!-- Main Application Script -->
    <script src="/assets/js/main.js" defer></script>

    <!-- Instant page loading: preloads pages on hover/touchstart -->
    <!-- Use explicit HTTPS instead of protocol-relative URL for security -->
    <script src="https://instant.page/5.2.0" type="module"
        integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z" crossorigin="anonymous"></script>
</body>

</html>