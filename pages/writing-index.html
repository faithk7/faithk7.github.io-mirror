---
layout: default
title: Writing
paginate: true
permalink: /writing-index
description: "Kai Qu's writing index page"
head_include: head.html
---

<div class="c-writing-index-container">
    <h1 class="o-writing-index-title">Writing</h1>
    {% assign posts_collection = site.collections.posts.docs | default: site.posts %}
    {% assign sorted_posts = posts_collection | where_exp: "post", "post.hidden != true" | sort: 'date' | reverse %}
    {%- comment -%} Post count: {{ sorted_posts.size }} {%- endcomment -%}

    <div id="tag-container" class="c-tag-container-meta">
        <button type="button" class="o-tag selected-tag" id="all-tag" data-tag="">all</button><span
            style="margin-left: 3px; margin-right: 7px">|</span>
        {% assign tags = "" %}
        {% for post in sorted_posts %}
        {% for tag in post.tags %}
        {% assign tags = tags | append: tag | append: "," %}
        {% endfor %}
        {% endfor %}
        {% assign unique_tags = tags | split: "," | uniq | sort %}
        {% for tag in unique_tags reversed %}
        {% if tag != "" %}
        <button type="button" class="o-tag" data-tag="{{ tag }}">{{ tag }}</button>
        {% endif %}
        {% endfor %}
    </div>

    {% for post in sorted_posts %}
    <div class="c-writing-item-container" data-tags="{{ post.tags | join: ' ' }}">
        <h3 class="o-post-title"><a href="{{ post.url }}">{{ post.title | replace: "| Kai Qu", "" }}</a>
        </h3>
        <div class="c-post-meta-container">
            <div class="o-writing-note-date">{{ post.date | date: "%B %d, %Y" }}</div>
            <div class="c-hashtag-container-post">
                {% for tag in post.tags %}
                <button type="button" class="o-post-tag" data-tag="{{ tag }}">{{ tag }}</button>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- JavaScript moved to bottom -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.addEventListener('click', function (e) {
            var btn = e.target && e.target.closest && e.target.closest('button[data-tag]');
            if (!btn) return;
            filterPosts(btn.getAttribute('data-tag') || '');
        });
    });

    function filterPosts(tag) {
        var posts = document.querySelectorAll('.c-writing-item-container');

        // Filter posts
        posts.forEach(function (post) {
            var postTags = post.getAttribute('data-tags').split(' ');
            if (postTags.includes(tag) || tag === '') {
                post.style.display = 'flex';
            } else {
                post.style.display = 'none';
            }
        });

        // Update tag underline
        updateTagUnderline(tag);
    }

    function updateTagUnderline(selectedTag) {
        var tags = document.querySelectorAll('.o-tag[data-tag]');
        tags.forEach(function (tagElement) {
            if ((tagElement.getAttribute('data-tag') || '') === selectedTag) {
                tagElement.classList.add('selected-tag');
            } else {
                tagElement.classList.remove('selected-tag');
            }
        });
    }
</script>


